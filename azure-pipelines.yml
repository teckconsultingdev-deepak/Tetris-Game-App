
# Build and push Docker image to Azure Container Registry (ACR)
# Self-hosted Azure DevOps agent

trigger:
- main

pool:
  name: Default

variables:
  dockerRegistryServiceConnection: '3944071b-1303-4003-ac55-a717adc5d1a8'
  imageRepository: 'tetrisgameapp'   # âœ… FIXED IMAGE NAME
  dockerfilePath: '$(Build.SourcesDirectory)/Dockerfile'
  tag: '$(Build.BuildId)'

steps:
- checkout: self

- task: Docker@2
  displayName: Build and push Docker image to ACR
  inputs:
    command: buildAndPush
    repository: $(imageRepository)
    dockerfile: $(dockerfilePath)
    containerRegistry: $(dockerRegistryServiceConnection)
    tags: |
      $(tag)
